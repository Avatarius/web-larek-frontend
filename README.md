# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Документация классов

### Базовый код:
1. Api.
Базовый класс для осуществления низкоуровневых операций с api. Реализует паттерн singleton.
Имеет методы:
get - отправить get запрос по заданному адресу с указанными параметрами.
post - отправить post запрос по заданному адресу с указанными параметрами.
getInstance - создаёт экземпляр класса, если он ещё не был создан, в обратном случае возвращает ранее созданный экземпляр.
2. EventEmitter.
Брокер событий, реализует паттерн "Наблюдатель".
Имеет методы:
on - для подписки на событие.
off - для отписки от события.
emit - для уведомления подписчиков о наступлении события.
onAll - для подписки на все события.
offAll - для сброса всех подписчиков.
trigger - делает коллбек триггер, генерирующий событие при вызове.
3. Model.
Базовый абстрактный класс для всех классов - моделей. В конструктор на вход принимает данные в виде объекта и брокер событий(EventEmitter). Использует EventEmitter
посредством ассоциации.
Имеет метод emitChanges - уведомляет подписчиков об изменениях модели, для этого используется EventEmitter.
4. View.
Базовый абстрактный класс для всех классов - отображений. В конструктор на вход принимает HTMLElement и устанавливает его в поле container.
Имеет в своем распоряжении методы для низкоуровневой работы с DOM объектами, такие как setText(установка текста в выбранный HTMLElement),
setHidden(скрыть переданный HTMLElement), setVisible(отобразить переданный HTMLElement), setImage(установка изображения и alt на переданный
HTMLElement).
И самый важный метод - render, для отрисовки элемента. Рендер осуществляется за счёт присваивания переданных данных текущему экземпляру
класса. Классы, которые наследуются от View должны иметь набор сеттеров для корректной обработки такого присваивания.

### Компоненты модели данных:
1. ShopApi.
Наследуется от базового класса Api. Осуществляет работу api конкретно данного магазина, реализует паттерн singleton.
Имеет методы:
getProductList - получает с сервера список товаров для дальнейшей передачи их в Catalog и отрисовки посредством CardView и CatalogView.
getProductItem - получает с сервера конкретный товар по id. Эти данные нужны для формирования заказа.
postOrder - отправляет post запрос на сервер, содержащий данные о заказе. Для этого нужны данные о заказе (способ оплаты, адрес, email, телефон)
и информация о купленных товарах(их id, общая стоимость)
2. Product.
Наследуется от базового класса Model. Представляет собой класс - адаптер и соответственно реализует паттерн "адаптер". В конструктор на вход принимает
объект, который поддерживает интерфейс IProductItem, полученный из Api. Имеет ряд методов для конвертации объекта в формат, удобный для классов - отображений,
такие как:
toProductCardUIObj - конвертация в объект, удобный для класса - отображения CardView, поддерживает интерфейс IProductCardUI.
toProductItemUIObj - конвертация в объект, удобный для класса - отображения ProductView, поддерживает интерфейс IProductItemUI.
toBasketItemUIObj - конвертация в объект, удобный для класса - отображения BasketItemView, поддерживает интерфейс IBasketItemUI.
3. Catalog.
Наследуется от базового класса Model. Представляет собой модель для коллекции товаров на главной странице.  Хранит список объектов, которые поддерживают
интерфейс IProductItem(чтобы иметь доступ к методам конвертации).
При добавлении объектов генерируется событие 'catalog:items-changed', по которому cardView и catalogView отрисовывает список карточек.
Имеет методы:
сеттер для массива товаров - установить массив Product в защищённое свойство items.
геттер для массива товаров - получить массив Product из защищенного свойства items.
getProduct - получить конкретный Product по id.
4. Basket.
Наследуется от базового класса Model. Представляет собой модель для коллекции товаров в корзине.  Хранит список объектов, которые поддерживают
интерфейс IProductItem(чтобы иметь доступ к методам конвертации).
В корзину нельзя добавить 2 или более одинаковых товаров. При добавлении или удалении товаров генерируется событие
'basket:items-changed', после чего BasketItemView и BasketView перерисовывает элементы корзины.
Имеет методы:
add - добавить товар в корзину
remove - удалить товар из корзины
геттер для массива товаров в корзине - получить массив объектов - товаров из защищенного свойства items.
геттер для количества товаров в корзине
5. Order.
Наследуется от базового класса Model. Представляет собой модель для заказа. Хранит информацию о заказе(способ оплаты,
адрес, email, телефон) и имеет ряд геттеров / сеттеров для этих свойств.
6. OrderBuilder.
Представляет собой билдер для Order и реализует паттерн "builder". Нужен для поэтапного формирования заказа.
Методы (они же этапы формирования заказа):
setDelivery - установка данных о доставке (адрес, способ оплаты)
setContacts - установка контактных данных (телефон, email)
setOrderList - установка данных о купленных товарах
Для получения итогового заказа используется метод getResult.

### Компоненты представления:
1. Modal.
Наследуется от базового класса View. Отвечает за отображение модального окна. В конструктор на вход принимает HTMLElement и EventEmitter.
Имеются свойства, хранящие html элементы, closeButton и content.
Имеет методы:
сеттер для контента - нужен, чтобы менять контент модального окна. Так как в проекте существует 5 видов модальных окон (информация о товаре,
содержимое корзины, форма доставки, форма контактов, окно успешной покупки) данный сеттер может использоваться, чтобы не создавать для каждого модального окна
отдельный объект, а использовать один и менять там контент.
open - отображает модальное окно
close - скрывает модальное окно
render - отрисовка модального окна на странице.
2. Form.
Наследуется от базового класса View. Отвечает за отображение формы. В конструктор на вход принимает HTMLElement и EventEmitter.
Имеет свойство, хранящий html элемент кнопки формы - submit. При вводе чего-либо в текстовом поле или при нажатии кнопки submit генерируются
соответствующие события через брокер событий.
Имеет методы:
сеттер valid - для блокировки / разблокировки кнопки submit.
render - рендер формы на странице.
3. CardView.
Наследуется от базового класса View. Отвечает за отображение карточки на главной странице. Содержит поля - html элементы, такие как
категория товара, имя товара, изображение товара, цена товара и геттеры / сеттеры для них. Сеттеры нужны для автоматического назначения значений в html элементы при вызове метода render.
При клике на карточку генерируется событие 'card:select'.
Содержит методы:
render - для отрисовки карточки.
набор сеттеров для установки значений в html элементы. (категория, имя товара, изображение товара, цена товара)
lockButton - блокировка кнопки ,если товар есть в корзине
4. CatalogView.
Наследуется от базового класса View. Отвечает за отображение контейнера для карточек на главной странице.
Содержит методы:
render - для отрисовки списка товаров на главной странице.
сеттер для установки элементов (списка карточек)
5. BasketItemView.
Наследуется от базового класса View. Отвечает за отображение отдельного товара в корзине. Содержит поля - html элементы карточки товара, такие как
индекс товара, имя товара, цена. кнопка удаления. При клике по кнопке удаления генерируется событие 'basket:item-changed'
Содержит методы:
render - для отрисовки карточки.
набор сеттеров для установки значений в html элементы. (категория, имя товара, изображение товара, цена товара)
6. BasketView.
Наследуется от базового класса View. Отвечает за отображение контейнера c корзиной.
Содержит методы:
render - для отрисовки списка товаров на главной странице.
сеттер для установки элементов (списка карточек)
Кнопка "оформить"  активна, если  в корзине есть товары. При клике на кнопку у объекта OrderBuilder вызывается метод setOrderList.



### Также необходимы дополнительные компоненты для формирования контента модальных окон, такие как ProductView, BasketView(описано ранее),
DeliveryView, ContactsView, SuccessView. Содержимое будет передано в сеттер контента Modal.
1. ProductView.
Наследуется от базового класса View. Отображает подробную информацию о товаре после клика по карточке(название товара, категория, изображение, цена)
и кнопку "купить". При клике на эту кнопку генерируется событие "basket:items-changed".
2. DeliveryView.
Наследуется от класса Form. Представляет собой форму для ввода данных о доставке (способ оплаты, адрес) и кнопку "далее". Кнопка становится активна после
ввода всех требуемых данных. При клике на кнопку у объекта OrderBuilder вызывается метод setDelivery.
3. ContactsView.
Наследуется от класса Form. Представляет собой форму для ввода контактных данных (email, телефон) и кнопку "далее". Кнопка становится активна после
ввода всех требуемых данных. При клике на кнопку у объекта OrderBuilder вызывается метод setContacts.
4. SuccessView.
Наследуется от класса View. Представляет собой окно для показа информации об успешной покупке, содержит кнопку "за новыми покупками!". При клике на кнопку
модальное окно закрывается, корзина очищается.
